set rulebase security rules Allow-DNS from User to External application dns-base action allow
set rulebase security rules Allow-DNS from Public to External application dns-base action allow

set rulebase security rules Allow-HTTP-HTTPS from User to External application web-browsing action allow
set rulebase security rules Allow-HTTP-HTTPS application ssl
set rulebase security rules Allow-HTTP-HTTPS from Public to External application web-browsing action allow
set rulebase security rules Allow-HTTP-HTTPS application ssl

set rulebase security rules Allow-SMTP from User to External application smtp-base action allow
set rulebase security rules Allow-SMTP from Public to External application smtp-base action allow

set rulebase security rules Allow-NTP from User to External application ntp-base action allow
set rulebase security rules Allow-NTP from Public to External application ntp-base action allow

set rulebase security rules Allow-ICMP from User to any application ping action allow
set rulebase security rules Allow-ICMP from Public to any application ping action allow


# DNS Traffic
set rulebase security rules Allow-DNS from User to External source any destination any application dns-base action allow
set rulebase security rules Allow-DNS from Public to External source any destination any application dns-base action allow

# HTTP/HTTPS Traffic
set rulebase security rules Allow-HTTP-HTTPS from User to External source any destination any application web-browsing action allow
set rulebase security rules Allow-HTTP-HTTPS from User to External source any destination any application ssl action allow
set rulebase security rules Allow-HTTP-HTTPS from Public to External source any destination any application web-browsing action allow
set rulebase security rules Allow-HTTP-HTTPS from Public to External source any destination any application ssl action allow

# SMTP Traffic
set rulebase security rules Allow-SMTP from User to External source any destination any application smtp-base action allow
set rulebase security rules Allow-SMTP from Public to External source any destination any application smtp-base action allow

# NTP Traffic
set rulebase security rules Allow-NTP from User to External source any destination any application ntp-base action allow
set rulebase security rules Allow-NTP from Public to External source any destination any application ntp-base action allow

# ICMP Traffic
set rulebase security rules Allow-ICMP from User to any source any destination any application ping action allow
set rulebase security rules Allow-ICMP from Public to any source any destination any application ping action allow






# Allow DNS (User → External)
set rulebase security rules Allow-DNS from User to External application dns service application-default action allow log-start yes log-end yes

# Allow HTTP/HTTPS (User → External)
set rulebase security rules Allow-HTTP-HTTPS from User to External application web-browsing ssl service application-default action allow log-start yes log-end yes

# Allow SMTP/POP3 (User → External)
set rulebase security rules Allow-SMTP-POP3 from User to External application smtp pop3 service application-default action allow log-start yes log-end yes

# Allow NTP (User → External)
set rulebase security rules Allow-NTP from User to External application ntp service application-default action allow log-start yes log-end yes

# Allow ICMP (Diagnostics - User → Any)
set rulebase security rules Allow-ICMP from User to any application ping service application-default action allow log-start yes log-end yes

# Deny Unauthorized Traffic (Final Deny Rule for User)
set rulebase security rules Deny-Unauthorized from User to any application any service any action deny log-start yes log-end yes
